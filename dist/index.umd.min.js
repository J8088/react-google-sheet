!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t(e.ReactGoogleSheet={},e.React)}(this,function(e,t){"use strict";function r(e){return function(){return e}}t=t&&t.hasOwnProperty("default")?t.default:t;var n=function(){};n.thatReturns=r,n.thatReturnsFalse=r(!1),n.thatReturnsTrue=r(!0),n.thatReturnsNull=r(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e};var o=n;var i=function(e,t,r,n,o,i,s,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,i,s,a],p=0;(c=new Error(t.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}})()&&Object.assign;var u,p="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",l=(function(e){e.exports=function(){function e(e,t,r,n,o,s){s!==p&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=o,r.PropTypes=r,r}()}(u={exports:{}},u.exports),u.exports);function h(e){return function(){return e}}var f=function(){};f.thatReturns=h,f.thatReturnsFalse=h(!1),f.thatReturnsTrue=h(!0),f.thatReturnsNull=h(null),f.thatReturnsThis=function(){return this},f.thatReturnsArgument=function(e){return e};var d=f;var y=function(e,t,r,n,o,i,s,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,i,s,a],p=0;(c=new Error(t.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},b=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}})()&&Object.assign;var g="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",O=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e){e.exports=function(){function e(e,t,r,n,o,i){i!==g&&y(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=d,r.PropTypes=r,r}()}),j=function(e,t,r,n,o,i,s,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,i,s,a],p=0;(c=new Error(t.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},P=function(){};var w=P;function x(){var e=!1;return function(t){w(e,t),e=!0}}var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},E=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},_=x();var I=function(e){function r(){var t,n,o,i,s;T(this,r);for(var a=arguments.length,c=Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=n=E(this,e.call.apply(e,[this].concat(c))),n.broadcast=(o=n.props.value,i=o,s=[],{getValue:function(){return i},publish:function(e){i=e,s.forEach(function(e){return e(i)})},subscribe:function(e){return s.push(e),function(){s=s.filter(function(t){return t!==e})}}}),E(n,t)}return C(r,e),r.prototype.getChildContext=function(){var e;return{broadcasts:R({},this.context.broadcasts,(e={},e[this.props.channel]=this.broadcast,e))}},r.prototype.componentWillMount=function(){_("<Broadcast> is deprecated and will be removed in the next major release. Please use createContext instead. See https://goo.gl/QAF37J for more info.")},r.prototype.componentWillReceiveProps=function(e){j(this.props.channel===e.channel,"You cannot change <Broadcast channel>"),this.props.compareValues(this.props.value,e.value)||this.broadcast.publish(e.value)},r.prototype.render=function(){return t.Children.only(this.props.children)},r}(t.Component);I.propTypes={channel:O.string.isRequired,children:O.node.isRequired,compareValues:O.func,value:O.any},I.defaultProps={compareValues:function(e,t){return e===t}},I.contextTypes={broadcasts:O.object},I.childContextTypes={broadcasts:O.object.isRequired};var q=x(),A=function(e){function t(){var r,n;T(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=E(this,e.call.apply(e,[this].concat(i))),n.state={value:void 0},E(n,r)}return C(t,e),t.prototype.getBroadcast=function(){var e=(this.context.broadcasts||{})[this.props.channel];return j(this.props.quiet||e,'<Subscriber channel="%s"> must be rendered in the context of a <Broadcast channel="%s">',this.props.channel,this.props.channel),e},t.prototype.componentWillMount=function(){q("<Subscriber> is deprecated and will be removed in the next major release. Please use createContext instead. See https://goo.gl/QAF37J for more info.");var e=this.getBroadcast();e&&this.setState({value:e.getValue()})},t.prototype.componentDidMount=function(){var e=this,t=this.getBroadcast();t&&(this.unsubscribe=t.subscribe(function(t){e.setState({value:t})}))},t.prototype.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe()},t.prototype.render=function(){var e=this.props.children;return e?e(this.state.value):null},t}(t.Component);A.propTypes={channel:O.string.isRequired,children:O.func,quiet:O.bool},A.defaultProps={quiet:!1},A.contextTypes={broadcasts:O.object};var k={string:O.string,number:O.number,function:O.func,boolean:O.bool};var D=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}("next")})}},V=function(e){var r,n,o="object"===(n=void 0===(r=e)?"undefined":S(r))?Array.isArray(r)?O.array:O.object:k[n]||O.any,i=Symbol(),s=function(e){function t(){var r,n;T(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=E(this,e.call.apply(e,[this].concat(i))),n.subscribers=[],n.publish=function(e){n.subscribers.forEach(function(t){return t(e)})},n.subscribe=function(e){return n.subscribers.push(e),function(){n.subscribers=n.subscribers.filter(function(t){return t!==e})}},E(n,r)}return C(t,e),t.prototype.getChildContext=function(){var e;return{broadcasts:R({},this.context.broadcasts,(e={},e[i]={initialValue:this.props.value,subscribe:this.subscribe},e))}},t.prototype.componentWillReceiveProps=function(e){this.props.value!==e.value&&this.publish(e.value)},t.prototype.render=function(){return this.props.children},t}(t.Component);s.defaultValue=e,s.propTypes={children:O.node,value:o},s.defaultProps={value:e},s.contextTypes={broadcasts:O.object},s.childContextTypes={broadcasts:O.object.isRequired};var a=function(t){function r(){var n,o;T(this,r);for(var s=arguments.length,a=Array(s),c=0;c<s;c++)a[c]=arguments[c];return n=o=E(this,t.call.apply(t,[this].concat(a))),o.broadcast=o.context.broadcasts&&o.context.broadcasts[i],o.state={value:o.broadcast?o.broadcast.initialValue:e},E(o,n)}return C(r,t),r.prototype.componentDidMount=function(){var e=this;this.broadcast?this.unsubscribe=this.broadcast.subscribe(function(t){e.setState({value:t})}):w(this.props.quiet,"<Consumer> was rendered outside the context of its <Provider>")},r.prototype.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe()},r.prototype.render=function(){var e=this.props.children;return e?e(this.state.value):null},r}(t.Component);return a.contextTypes={broadcasts:O.object},a.propTypes={children:O.func,quiet:O.bool},a.defaultProps={quiet:!1},{Provider:s,Consumer:a}}(null);const M=V.Provider,N=V.Consumer;M.displayName="GoogleApiProvider",N.displayName="GoogleApiConsumer";class B extends t.Component{constructor(...e){var t;return t=super(...e),this.authorize=(()=>{this.auth&&this.auth.signIn()}),this.signout=(()=>{this.auth&&this.auth.signOut()}),this.state={signedIn:!1,client:null,loading:!0,error:null,authorize:this.authorize,signout:this.signout},t}componentDidMount(){this.setupApi()}setupApi(){var e=this;return D(function*(){try{void 0===window.gapi&&(yield(t="https://apis.google.com/js/api.js",new Promise((e,r)=>{const n=document.createElement("script");n.onload=e,n.onerror=r,n.src=t,n.async=!0,n.type="text/javascript",document.head.appendChild(n)}))),gapi.client||(yield new Promise(function(e,t){return gapi.load("client:auth2",{callback:e,onerror:t})})),yield gapi.client.init({apiKey:e.props.apiKey,clientId:e.props.clientId,discoveryDocs:e.props.discoveryDocs,scope:e.props.scopes.join(",")})}catch(t){return void e.setState({loading:!1,error:t})}var t;e.auth=gapi.auth2.getAuthInstance(),e.setState({client:gapi.client,loading:!1,signedIn:e.auth.isSignedIn.get()}),e.auth.isSignedIn.listen(function(t){return e.setState({signedIn:t})})})()}render(){return t.createElement(M,{value:this.state},"function"==typeof this.props.children?this.props.children(this.state):this.props.children)}}B.propTypes={clientId:l.string.isRequired,apiKey:l.string.isRequired,discoveryDocs:l.arrayOf(l.string).isRequired,scopes:l.arrayOf(l.string).isRequired,children:l.oneOfType([l.func,l.node])};var W=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}("next")})}},U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};class F extends t.Component{constructor(e){super(e),this.state={error:null,data:null,loading:!1},this.fetch=this.fetch.bind(this)}componentDidMount(){this.fetch()}componentDidUpdate(e){(function(e,t,...r){return!r.some(r=>e[r]!==t[r])})(this.props,e,"id","range")||this.fetch()}fetch(){var e=this;return W(function*(){e.setState({loading:!0});try{const t={spreadsheetId:e.props.id,range:e.props.range},r=yield e.props.api.client.sheets.spreadsheets.values.get(t);e.props.id===t.spreadsheetId&&e.props.range===t.range&&e.setState({loading:!1,error:null,data:r.result.values})}catch(t){const r=t.result?t.result.error:t;e.setState({loading:!1,error:r})}})()}render(){return this.props.children({error:this.state.error,data:this.state.data,loading:this.state.loading,refetch:this.fetch})}}e.GoogleSheet=(e=>t.createElement(N,null,r=>t.createElement(F,U({api:r},e)))),e.GoogleSheetsApi=(e=>{var r=e.scopes;let n=void 0===r?["https://www.googleapis.com/auth/spreadsheets.readonly"]:r,o=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["scopes"]);return t.createElement(B,U({scopes:n,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]},o))}),Object.defineProperty(e,"__esModule",{value:!0})});
